<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Relic SLM ハンズオンガイド</title>
  </head>
  <body class="bg-gray-50 text-gray-900">
    <!-- ヘッダー -->
    <header id="header" class="bg-blue-600 text-white py-8 shadow-lg">
      <div class="container mx-auto px-6 flex items-center justify-between">
        <div>
          <h1 class="text-4xl font-bold">New Relic Service Level Management ハンズオン</h1>
          <p class="mt-3 text-xl">座学と実技で学ぶSLI/SLO設計・管理</p>
        </div>
        <img src="/images/nrug-sre.png" alt="NRUG-SRE マスコットキャラクター" class="h-24 w-auto hidden md:block"/>
      </div>
    </header>

    <!-- カリキュラム概要図 -->
    <div class="container mx-auto px-6 py-8">
      <div class="flex justify-center">
        <img src="/images/top.png" alt="New Relic SLM ハンズオンプロジェクト カリキュラム概要 - ハンズオンシナリオ、アプリケーションアーキテクチャ、New Relic監視統合の全体像" class="max-w-5xl w-full rounded-lg shadow-lg border border-gray-200"/>
      </div>
    </div>

    <!-- 目次 -->
    <nav id="toc" class="container mx-auto px-6 py-10">
      <h2 class="text-3xl font-bold mb-6 text-gray-800">目次</h2>
      <ul class="space-y-3 text-lg">
        <li>
          <a href="#codespaces-start" class="text-blue-600 hover:text-blue-800 hover:underline font-medium">
            0. GitHub Codespacesの起動
          </a>
          <span class="ml-2 text-sm text-gray-500">※起動に時間がかかるため、先に実施します</span>
        </li>
        <li>
          <a href="#lecture" class="text-blue-600 hover:text-blue-800 hover:underline font-medium">
            1. 座学: Service Level Management基礎 (推奨時間: 20分)
          </a>
        </li>
        <li>
          <a href="#setup" class="text-blue-600 hover:text-blue-800 hover:underline font-medium">
            2. 環境セットアップ (推奨時間: 30分)
          </a>
        </li>
        <li class="text-gray-500 italic">
          休憩時間: 10分
        </li>
        <li>
          <a href="#slo-management" class="text-blue-600 hover:text-blue-800 hover:underline font-medium">
            3. SLO設定・管理 (推奨時間: 30分)
          </a>
        </li>
      </ul>
    </nav>

    <!-- GitHub Codespaces起動セクション -->
    <section id="codespaces-start" class="container mx-auto px-6 py-10 bg-white rounded-lg shadow-md mb-10">
      <h2 class="text-3xl font-bold mb-4 text-gray-800">GitHub Codespacesの起動</h2>
      <p class="text-sm text-gray-600 mb-6">※起動に時間がかかるため、先に実施します</p>

      <div class="bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500 mb-6">
        <p class="font-semibold text-yellow-800 mb-2">Codespacesの起動には数分かかります</p>
        <p class="text-gray-700">起動を開始したら、次の座学セクションに進んでください。Codespacesの準備が完了する頃には座学が終わっています。</p>
      </div>

      <div class="space-y-4 text-gray-700">
        <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500">
          <p class="font-semibold text-lg mb-3">開発環境の選択肢</p>
          <ul class="list-disc list-inside space-y-2">
            <li><strong>GitHub Codespaces（推奨）:</strong> ブラウザ上で完結する開発環境</li>
            <li><strong>ローカル環境:</strong> Docker Desktop導入済みの場合</li>
          </ul>
        </div>

        <h3 class="font-bold text-xl mt-6 text-gray-800">手順: GitHub Codespacesで起動</h3>
        <ol class="list-decimal list-inside space-y-3 ml-4">
          <li>
            <a href="https://github.com/NRUG-SRE/slm-handson" target="_blank" class="text-blue-600 hover:underline font-semibold">
              GitHubリポジトリ
            </a>
            にアクセス
          </li>
          <li>緑色の「Code」ボタンをクリック</li>
          <li>「Codespaces」タブを選択</li>
          <li>「Create codespace on main」をクリック</li>
          <li>起動が始まったら、次の座学セクションに進んでください</li>
        </ol>

        <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500 mt-6">
          <p class="font-semibold text-green-800">起動完了の確認</p>
          <p class="text-gray-700 mt-2">VS Codeのような画面がブラウザ上に表示され、ターミナルが使えるようになれば準備完了です。</p>
        </div>
      </div>

      <!-- ナビゲーションボタン -->
      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#toc" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition">
          ← 目次へ戻る
        </a>
        <a href="#lecture" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
          次へ: 座学（起動中に進めます） →
        </a>
      </div>
    </section>

    <!-- 座学セクション -->
    <section id="lecture" class="container mx-auto px-6 py-10 bg-white rounded-lg shadow-md mb-10">
      <h2 class="text-3xl font-bold mb-4 text-gray-800">座学: Service Level Management基礎</h2>
      <p class="text-sm text-gray-600 mb-6">推奨時間: 20分</p>

      <!-- スライドコンテナ -->
      <div id="slide-container" class="min-h-[500px] mb-8">
        <!-- スライド1 -->
        <div class="slide" data-slide="0">
          <div class="flex flex-col items-center">
            <img src="/images/nrug-sre.png" alt="NRUG-SRE マスコットキャラクター" class="h-32 w-auto mb-6"/>
            <h3 class="text-3xl font-bold mb-6 text-center text-blue-700">AI時代におけるService Level Management</h3>
            <p class="text-xl text-gray-700 text-center mt-4">プロダクトオーナー、PM、SRE、開発者のための</p>
            <p class="text-2xl font-semibold text-center text-blue-600 mt-4">実践的SLI/SLO設計ガイド</p>
          </div>
        </div>

        <!-- スライド2: 目次 -->
        <div class="slide hidden" data-slide="1">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">目次</h3>
          <div class="space-y-4 mt-8">
            <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
              <span class="text-2xl font-bold text-blue-600">1</span>
              <p class="text-lg text-gray-700">Service Level Managementの本質</p>
            </div>
            <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
              <span class="text-2xl font-bold text-blue-600">2</span>
              <p class="text-lg text-gray-700">可用性と機能のバランス</p>
            </div>
            <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
              <span class="text-2xl font-bold text-blue-600">3</span>
              <p class="text-lg text-gray-700">SLOが高すぎることの弊害</p>
            </div>
            <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-lg">
              <span class="text-2xl font-bold text-blue-600">4</span>
              <p class="text-lg text-gray-700">SLA / SLI / SLO の理解</p>
            </div>
          </div>
        </div>

        <!-- スライド3 -->
        <div class="slide hidden" data-slide="2">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">よくある構図</h3>
          <div class="grid grid-cols-2 gap-8 mt-6">
            <!-- 左側: リスト -->
            <div class="space-y-4 text-lg text-gray-700">
              <p class="font-semibold text-xl mb-6">品質向上の取り組み例</p>
              <ul class="list-disc list-inside space-y-3 ml-4 text-lg">
                <li>月次・週次報告書</li>
                <li>改善提案書</li>
                <li>障害報告書</li>
                <li>再発防止策</li>
                <li>品質向上レポート</li>
              </ul>
            </div>

            <!-- 右側: フロー図 -->
            <div class="flex flex-col items-center justify-center space-y-6">
              <!-- 開発者/運用者 -->
              <div class="bg-blue-100 p-4 rounded-lg border-2 border-blue-400 w-64 text-center">
                <p class="text-lg font-bold text-blue-800">開発者 / SRE / 運用者</p>
                <p class="text-xs text-gray-600 mt-1">報告書を作成する側</p>
              </div>

              <!-- 下向き矢印 -->
              <div class="flex flex-col items-center">
                <div class="text-4xl text-gray-400">↓</div>
                <p class="text-sm text-gray-600 font-semibold">報告書を提出</p>
              </div>

              <!-- PO/マネージャー -->
              <div class="bg-green-100 p-4 rounded-lg border-2 border-green-400 w-64 text-center">
                <p class="text-lg font-bold text-green-800">PO / マネージャー</p>
                <p class="text-xs text-gray-600 mt-1">報告書を受け取る側</p>
              </div>
            </div>
          </div>
        </div>

        <!-- スライド4 -->
        <div class="slide hidden" data-slide="3">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">ユーザー視点で考えると、プロダクトにも恩恵がある</h3>
          <div class="grid grid-cols-2 gap-8 mt-6">
            <!-- 左側: ユーザー視点 -->
            <div class="space-y-4">
              <div class="bg-blue-50 p-6 rounded-lg border-2 border-blue-400">
                <h4 class="text-xl font-bold text-blue-800 mb-3 text-center">📊 ユーザー視点での品質向上</h4>
                <p class="text-gray-700 text-center mb-3">高い可用性による良質なユーザー体験</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                  <li>サービスが期待通りに動く</li>
                  <li>ストレスなく使える</li>
                  <li>信頼できる</li>
                </ul>
              </div>
            </div>

            <!-- 右側: プロダクト恩恵 -->
            <div class="space-y-4">
              <div class="bg-green-50 p-6 rounded-lg border-2 border-green-400">
                <h4 class="text-xl font-bold text-green-800 mb-3 text-center">📈 プロダクトへの恩恵</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                  <li><strong>利用継続率が向上</strong> → ユーザー数増加</li>
                  <li><strong>口コミによる新規獲得</strong> → 利用量拡大</li>
                  <li><strong>ロイヤルティ向上</strong> → 単価アップ</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- 中央の矢印とまとめ -->
          <div class="flex flex-col items-center mt-6 space-y-4">
            <div class="flex items-center space-x-4">
              <div class="text-4xl text-green-600">→</div>
            </div>
            <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500 max-w-3xl">
              <p class="text-gray-700 text-center font-semibold">
                品質向上の取り組みは、<strong class="text-purple-700">ユーザー視点</strong>を起点にすることで、<strong class="text-green-700">プロダクト指標も自然に向上</strong>する
              </p>
            </div>
          </div>
        </div>

        <!-- スライド5 -->
        <div class="slide hidden" data-slide="4">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">Service Level Managementの本質</h3>
          <div class="space-y-8 text-lg text-gray-700 mt-8">
            <div class="bg-yellow-50 p-8 rounded-lg border-l-4 border-yellow-500">
              <p class="font-semibold text-2xl mb-4 text-yellow-800">ユーザーが期待するサービス品質を定量的に測定し、継続的に改善する</p>
            </div>

            <div class="bg-blue-50 p-6 rounded-lg border-2 border-blue-300">
              <p class="font-bold text-xl text-blue-800 mb-4">SLMによる品質向上サイクル</p>
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                <div class="bg-white p-4 rounded-lg text-center">
                  <p class="text-3xl mb-2">📊</p>
                  <p class="font-semibold text-blue-700">測定</p>
                  <p class="text-sm text-gray-600 mt-2">ユーザー体験を数値化</p>
                </div>
                <div class="bg-white p-4 rounded-lg text-center">
                  <p class="text-3xl mb-2">🎯</p>
                  <p class="font-semibold text-blue-700">目標設定</p>
                  <p class="text-sm text-gray-600 mt-2">適切なSLO策定</p>
                </div>
                <div class="bg-white p-4 rounded-lg text-center">
                  <p class="text-3xl mb-2">🔄</p>
                  <p class="font-semibold text-blue-700">改善</p>
                  <p class="text-sm text-gray-600 mt-2">継続的な最適化</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- スライド6 -->
        <div class="slide hidden" data-slide="5">
          <h3 class="text-3xl font-bold mb-8 text-center text-blue-700">可用性 vs 機能</h3>
          <div class="bg-gray-100 p-6 rounded-lg mb-6 max-w-3xl mx-auto">
            <p class="text-lg text-gray-700 mb-3">
              <span class="font-bold text-blue-600">📋 シチュエーション：</span>
            </p>
            <p class="text-gray-700 mb-2">
              あなたは忙しいビジネスパーソン。毎日多くのタスクを抱えていて、
              <strong>TODO管理アプリ</strong>で仕事を整理しています。
            </p>
            <p class="text-gray-700">
              新しいTODO管理アプリを探していて、2つの候補が見つかりました。
            </p>
          </div>
          <p class="text-xl text-center text-gray-700 font-bold">次の2つのTODOアプリ、あなたはどちらを選びますか？</p>
        </div>

        <!-- スライド7 -->
        <div class="slide hidden" data-slide="6">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">📝 AのTODOアプリ</h3>
          <div class="grid grid-cols-2 gap-6 mt-6">
            <!-- 良い点 -->
            <div class="bg-green-50 p-6 rounded-lg border-2 border-green-400">
              <h4 class="text-xl font-bold text-green-700 mb-4 text-center">✅ 良い点</h4>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>可用性100%</strong></li>
                <li>タスク登録・完了が絶対に成功する</li>
                <li>毎日安定して使える</li>
                <li>ストレスフリー</li>
              </ul>
            </div>
            <!-- 悪い点 -->
            <div class="bg-red-50 p-6 rounded-lg border-2 border-red-400">
              <h4 class="text-xl font-bold text-red-700 mb-4 text-center">❌ 悪い点</h4>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>機能が最小限</strong></li>
                <li>タスクの登録と完了のみ</li>
                <li>リマインダーや共有機能なし</li>
                <li>シンプルすぎて物足りない</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- スライド8 -->
        <div class="slide hidden" data-slide="7">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">📝 BのTODOアプリ</h3>
          <div class="grid grid-cols-2 gap-6 mt-6">
            <!-- 良い点 -->
            <div class="bg-green-50 p-6 rounded-lg border-2 border-green-400">
              <h4 class="text-xl font-bold text-green-700 mb-4 text-center">✅ 良い点</h4>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>機能が非常に豊富</strong></li>
                <li>リマインダー、タグ、共有機能</li>
                <li>カレンダー連携、繰り返しタスク</li>
                <li>NotionやBacklogのような使い心地</li>
              </ul>
            </div>
            <!-- 悪い点 -->
            <div class="bg-red-50 p-6 rounded-lg border-2 border-red-400">
              <h4 class="text-xl font-bold text-red-700 mb-4 text-center">❌ 悪い点</h4>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>可用性約66%</strong></li>
                <li>3回に1回タスク登録が失敗する</li>
                <li>大事な会議前にアプリが落ちることも</li>
                <li>「あれ、登録したはずなのに...」</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- スライド9 -->
        <div class="slide hidden" data-slide="8">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">信頼性を基準としたバランス</h3>
          <div class="space-y-6 text-lg text-gray-700 mt-8">
            <div class="bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500">
              <p class="font-semibold text-xl mb-3">結論</p>
              <p>どちらも極端すぎる。<strong class="text-blue-600">信頼性（Reliability）</strong>を基準にバランスをとることが重要。</p>
            </div>
            <div class="grid grid-cols-2 gap-6 mt-8">
              <div class="bg-red-50 p-6 rounded-lg border-l-4 border-red-400">
                <p class="font-bold text-lg mb-3 text-red-700">可用性を犠牲にした機能追加</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>複雑性が増す</li>
                  <li>バグが増える</li>
                  <li>信頼性が低下する</li>
                </ul>
              </div>
              <div class="bg-green-50 p-6 rounded-lg border-l-4 border-green-400">
                <p class="font-bold text-lg mb-3 text-green-700">適切なバランス</p>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>ユーザーに必要な機能</li>
                  <li>高い信頼性（可用性）</li>
                  <li>持続可能な開発速度</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- スライド10 -->
        <div class="slide hidden" data-slide="9">
          <h3 class="text-3xl font-bold mb-8 text-center text-blue-700">ちょっと待って... 🤔</h3>
          <div class="flex flex-col items-center justify-center mt-12">
            <div class="bg-blue-50 p-8 rounded-xl border-2 border-blue-300 max-w-2xl">
              <p class="text-2xl text-center text-gray-700 leading-relaxed">
                「バランス」って言うけど...
              </p>
              <p class="text-3xl text-center text-blue-700 font-bold mt-6">
                100%の可用性<span class="text-gray-500 text-2xl"> と </span>魅力的な機能
              </p>
              <p class="text-2xl text-center text-gray-700 mt-6">
                両方備えればいいのでは？
              </p>
            </div>
          </div>
        </div>

        <!-- スライド11 -->
        <div class="slide hidden" data-slide="10">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">SLOに9を一つ追加するたびに...</h3>
          <div class="space-y-6 text-lg text-gray-700 mt-8">
            <div class="bg-red-50 p-6 rounded-lg border-l-4 border-red-500">
              <p class="font-semibold text-xl mb-3 text-red-700">必要となる労力とコストが指数関数的に増加</p>
            </div>
            <div class="grid grid-cols-2 gap-6 mt-8">
              <div>
                <h4 class="font-bold text-lg mb-3 text-gray-800">インフラコスト</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>冗長化（マルチAZ、マルチリージョン）</li>
                  <li>ロードバランサーの増強</li>
                  <li>データベースのレプリケーション</li>
                </ul>
              </div>
              <div>
                <h4 class="font-bold text-lg mb-3 text-gray-800">運用コスト</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>24時間365日のオンコール体制</li>
                  <li>監視システムの強化</li>
                  <li>インシデント対応プロセスの整備</li>
                </ul>
              </div>
            </div>
            <div class="grid grid-cols-2 gap-6 mt-6">
              <div>
                <h4 class="font-bold text-lg mb-3 text-gray-800">開発コスト</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>テストの厳格化</li>
                  <li>デプロイ自動化の高度化</li>
                  <li>カナリアリリース、ブルーグリーンデプロイ</li>
                </ul>
              </div>
              <div>
                <h4 class="font-bold text-lg mb-3 text-gray-800">機会コスト</h4>
                <ul class="list-disc list-inside space-y-2 text-gray-700">
                  <li>新機能開発の優先度低下</li>
                  <li>リスク回避のための保守的な判断</li>
                  <li>技術的負債の蓄積</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <!-- スライド12: 参考資料 - SLO比較表 -->
        <div class="slide hidden" data-slide="11">
          <div class="flex items-center justify-between mb-6">
            <h3 class="text-2xl font-bold text-blue-700">SLOレベル比較表</h3>
            <span class="text-sm bg-gray-200 text-gray-700 px-3 py-1 rounded-full">📚 参考資料</span>
          </div>
          <div class="overflow-x-auto mt-6">
            <table class="w-full border-collapse">
              <thead>
                <tr class="bg-blue-600 text-white">
                  <th class="border border-blue-700 px-4 py-3 text-left">SLOレベル</th>
                  <th class="border border-blue-700 px-4 py-3 text-left">月間ダウンタイム許容</th>
                  <th class="border border-blue-700 px-4 py-3 text-left">年間ダウンタイム許容</th>
                </tr>
              </thead>
              <tbody class="text-lg">
                <tr class="bg-gray-50">
                  <td class="border border-gray-300 px-4 py-3 font-semibold">90%</td>
                  <td class="border border-gray-300 px-4 py-3">3日</td>
                  <td class="border border-gray-300 px-4 py-3">36.5日</td>
                </tr>
                <tr class="bg-white">
                  <td class="border border-gray-300 px-4 py-3 font-semibold">99%</td>
                  <td class="border border-gray-300 px-4 py-3">7時間12分</td>
                  <td class="border border-gray-300 px-4 py-3">3.65日</td>
                </tr>
                <tr class="bg-blue-50">
                  <td class="border border-gray-300 px-4 py-3 font-semibold text-blue-700">99.9%</td>
                  <td class="border border-gray-300 px-4 py-3">43分12秒</td>
                  <td class="border border-gray-300 px-4 py-3">8.76時間</td>
                </tr>
                <tr class="bg-green-50">
                  <td class="border border-gray-300 px-4 py-3 font-semibold text-green-700">99.99%</td>
                  <td class="border border-gray-300 px-4 py-3">4分19秒</td>
                  <td class="border border-gray-300 px-4 py-3">52.56分</td>
                </tr>
                <tr class="bg-yellow-50">
                  <td class="border border-gray-300 px-4 py-3 font-semibold text-yellow-700">99.999%</td>
                  <td class="border border-gray-300 px-4 py-3">26秒</td>
                  <td class="border border-gray-300 px-4 py-3">5.26分</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="mt-6 bg-gray-50 p-4 rounded-lg border-l-4 border-gray-400">
            <p class="text-sm text-gray-700">
              <strong>💡 参考:</strong> SLOは稼働時間で計測するべきではありませんが、難易度の参考として参照してください。
              SLOレベルが高いほど達成難易度が上がり、ビジネス要件とコストのバランスを考慮した適切な設定が重要です。
            </p>
          </div>
        </div>

        <!-- スライド13 -->
        <div class="slide hidden" data-slide="12">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">SLA（Service Level Agreement）</h3>
          <div class="bg-blue-50 p-4 rounded-lg border-2 border-blue-400 mb-6">
            <p class="text-lg font-semibold text-blue-800 mb-2">顧客との契約上の合意</p>
            <p class="text-gray-700">サービス提供者が顧客に対して保証するサービス品質の水準</p>
          </div>

          <div class="grid grid-cols-2 gap-6">
            <!-- 左側: SLAの本質 -->
            <div class="bg-yellow-50 p-5 rounded-lg border-l-4 border-yellow-500">
              <p class="font-bold text-lg text-gray-800 mb-3">SLAの本質</p>
              <p class="text-gray-700 text-sm mb-3">利用前のユーザーに安心して利用の意思決定をしてもらうため、ビジネスが優位に進むことを期待して採用される手段</p>
              <div class="mt-3 bg-white p-3 rounded-lg">
                <p class="text-sm text-gray-700"><strong class="text-yellow-700">「信頼の前借り」</strong>というイメージを持つと良い</p>
              </div>
            </div>

            <!-- 右側: 特徴 -->
            <div class="bg-white p-5 rounded-lg border-2 border-gray-300">
              <p class="font-bold text-lg text-gray-800 mb-3">特徴</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                <li>法的拘束力を持つ契約</li>
                <li>違反時の補償・ペナルティが定義される</li>
                <li>外部に公開される（顧客向け）</li>
                <li>例: 「可用性99.9%を保証、違反時は利用料金の10%を返金」</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- スライド14 -->
        <div class="slide hidden" data-slide="13">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">SLI（Service Level Indicator）</h3>
          <div class="bg-green-50 p-8 rounded-lg border-2 border-green-400 mt-8">
            <p class="text-xl font-semibold text-green-800 mb-4">サービス品質の測定指標</p>
            <p class="text-lg text-gray-700 mb-6">サービスのパフォーマンスを定量的に測定するメトリクス</p>
            <div class="bg-white p-6 rounded-lg mt-6">
              <p class="font-bold text-lg text-gray-800 mb-3">代表的なSLI:</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li><strong>可用性（Availability）:</strong> 成功したリクエスト数 / 全リクエスト数</li>
                <li><strong>レイテンシ（Latency）:</strong> リクエストのレスポンス時間（95パーセンタイル等）</li>
                <li><strong>スループット（Throughput）:</strong> 単位時間あたりの処理リクエスト数</li>
                <li><strong>エラー率（Error Rate）:</strong> エラーリクエスト数 / 全リクエスト数</li>
              </ul>
            </div>
          </div>
        </div>

        <!-- スライド15 -->
        <div class="slide hidden" data-slide="14">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">SLO（Service Level Objective）</h3>
          <div class="bg-yellow-50 p-8 rounded-lg border-2 border-yellow-400 mt-8">
            <p class="text-xl font-semibold text-yellow-800 mb-4">内部目標値</p>
            <p class="text-lg text-gray-700 mb-6">SLIに対して設定する具体的な目標値（内部運用基準）</p>
            <div class="bg-white p-6 rounded-lg mt-6">
              <p class="font-bold text-lg text-gray-800 mb-3">特徴:</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700">
                <li>内部チーム向けの運用指標</li>
                <li>エラーバジェットの算出に使用</li>
                <li>機能開発とサービス信頼性のバランスを取るための指標</li>
                <li>例: 「可用性 &gt;= 99.9%」「レスポンスタイム95パーセンタイル &lt; 300ms」</li>
              </ul>
            </div>
            <div class="mt-6 bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500">
              <p class="font-bold text-gray-800 mb-2">💡 SLAとの関係</p>
              <p class="text-gray-700 text-sm">一般的にはSLAより厳しく設定してバッファを確保しますが、必須ではありません。機能や顧客セグメントによって柔軟に設定可能です。SLAがない場合でも、SLOは有効です。</p>
            </div>
            <div class="mt-4 bg-blue-50 p-4 rounded-lg">
              <p class="text-gray-700"><strong>関係:</strong> SLI（測定） → SLO（目標） → SLA（契約、オプション）</p>
            </div>
          </div>
        </div>

        <!-- スライド16 -->
        <div class="slide hidden" data-slide="15">
          <h3 class="text-2xl font-bold mb-6 text-blue-700">SLIとSLOの設計方法</h3>
          <div class="space-y-6 text-lg text-gray-700 mt-6">
            <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500">
              <p class="font-semibold text-xl mb-3">1. 成功率ベースのSLI/SLO</p>
              <p><strong>SLI:</strong> 成功したリクエスト数 / 全リクエスト数</p>
              <p class="mt-2"><strong>SLO例:</strong> 商品詳細ページの成功率 >= 99.9%</p>
              <p class="mt-2 text-gray-600">→ 1000リクエストのうち999回は成功する必要がある</p>
            </div>
            <div class="bg-green-50 p-6 rounded-lg border-l-4 border-green-500">
              <p class="font-semibold text-xl mb-3">2. レスポンスタイムベースのSLI/SLO</p>
              <p><strong>SLI:</strong> 指定時間内に完了したリクエスト数 / 全リクエスト数</p>
              <p class="mt-2"><strong>SLO例:</strong> カート追加APIのレスポンスタイム95パーセンタイル &lt; 300ms</p>
              <p class="mt-2 text-gray-600">→ 100リクエストのうち95回は300ms以内に完了する必要がある</p>
            </div>
            <div class="mt-6 bg-yellow-50 p-4 rounded-lg">
              <p class="font-bold text-gray-800">ポイント: ユーザー視点で重要な指標を選択する</p>
            </div>
          </div>
        </div>
      </div>

      <!-- スライドナビゲーション -->
      <div class="flex justify-between items-center py-4 border-t border-b border-gray-300 mb-6">
        <button id="prevSlideBtn" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition disabled:opacity-50 disabled:cursor-not-allowed" disabled>
          ← 前へ
        </button>
        <div class="flex items-center space-x-4">
          <span id="slideCounter" class="text-lg font-semibold text-gray-700">1 / 16</span>
          <button id="fullscreenBtn" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition flex items-center space-x-2" title="フルスクリーン表示">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
            </svg>
            <span>最大化</span>
          </button>
        </div>
        <button id="nextSlideBtn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
          次へ →
        </button>
      </div>

      <!-- フルスクリーンモーダル -->
      <div id="fullscreenModal" class="fixed inset-0 bg-white z-50 hidden flex-col">
        <!-- フルスクリーンヘッダー -->
        <div class="flex justify-between items-center px-8 py-4 bg-blue-600 text-white">
          <h2 class="text-2xl font-bold">座学: Service Level Management基礎</h2>
          <button id="exitFullscreenBtn" class="px-4 py-2 bg-white text-blue-600 rounded-lg hover:bg-gray-100 transition flex items-center space-x-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
            <span>閉じる (ESC)</span>
          </button>
        </div>
        <!-- フルスクリーンコンテンツ -->
        <div id="fullscreenContent" class="flex-1 overflow-auto p-8 flex items-center justify-center">
          <!-- スライドコンテンツがここにコピーされる -->
        </div>
        <!-- フルスクリーンナビゲーション -->
        <div class="flex justify-between items-center px-8 py-4 bg-gray-100 border-t border-gray-300">
          <button id="fullscreenPrevBtn" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition disabled:opacity-50 disabled:cursor-not-allowed">
            ← 前へ
          </button>
          <span id="fullscreenCounter" class="text-lg font-semibold text-gray-700">1 / 15</span>
          <button id="fullscreenNextBtn" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed">
            次へ →
          </button>
        </div>
      </div>

      <!-- セクションナビゲーションボタン -->
      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#codespaces-start" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition">
          ← 前へ: Codespacesの起動
        </a>
        <a href="#setup" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
          次へ: 環境セットアップ →
        </a>
      </div>
    </section>

    <!-- 環境セットアップセクション -->
    <section id="setup" class="container mx-auto px-6 py-10 bg-white rounded-lg shadow-md mb-10">
      <h2 class="text-3xl font-bold mb-4 text-gray-800">環境セットアップ</h2>
      <p class="text-sm text-gray-600 mb-6">推奨時間: 30分</p>

      <!-- アーキテクチャ図 -->
      <div class="mb-10 flex justify-center">
        <img src="/images/architecture.svg" alt="SLMハンズオンアーキテクチャ図 - フロントエンド（Next.js）、バックエンドAPI（Go）、負荷生成（Playwright）、New Relic Service Level Management" class="max-w-4xl w-full rounded-lg shadow-lg border-2 border-gray-200"/>
      </div>

      <!-- 1. New Relic設定 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">1. New Relic設定</h3>
        <div class="space-y-4 text-gray-700">

          <!-- APM用License Key -->
          <h4 class="font-bold text-lg text-gray-800">手順1: APM用 License Keyの作成</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>
              <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                New Relic
              </a>
              にログイン
            </li>
            <li>左下のユーザーアイコン → 「API Keys」をクリック</li>
            <li>「Create a key」ボタンをクリック</li>
            <li>「Key type」で <strong>Ingest - License</strong> を選択</li>
            <li>「Create a key」ボタンをクリックしてキーを作成</li>
            <li>表示されたAPI Keyの「Copy key」をクリックしてコピー</li>
          </ol>

          <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-500 mt-4">
            <p class="font-semibold text-red-800">⚠️ 重要: この画面を閉じるとキーを再表示できません</p>
            <p class="text-gray-700 mt-2">作成したキーは必ずこの時点でコピーしてください。画面を閉じた後は再度表示することができません。閉じてしまった場合は、再度キーを作成してください。</p>
          </div>

          <!-- RUM用設定 -->
          <h4 class="font-bold text-lg mt-8 text-gray-800">手順2: RUM用設定（Browser Key、Account ID、Application ID）の取得</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>New Relic UI → 左メニューから「Browser」を選択</li>
            <li>「Add your first browser app」をクリック</li>
            <li>「Browser monitoring」→「Place a JavaScript snippet in frontend code」を選択</li>
            <li>アプリ名を入力（例：<code class="bg-gray-100 px-2 py-1 rounded">slm-handson-frontend</code>）して「Save and continue」</li>
            <li>「Configure the browser agent」では、そのまま「Save and continue」</li>
            <li>生成されたJavaScriptスニペットから以下の値を抽出</li>
          </ol>

          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-4">
            <p class="font-semibold text-blue-800 mb-2">スニペットから抽出する値</p>
            <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto text-sm"><code class="language-javascript">// スニペット内の NREUM.loader_config から抽出
NREUM.loader_config={
  accountID:"9999999",        // ← NEXT_PUBLIC_NEW_RELIC_ACCOUNT_ID
  applicationID:"111111111",  // ← NEXT_PUBLIC_NEW_RELIC_APPLICATION_ID
  licenseKey:"NRBR-*****"     // ← NEXT_PUBLIC_NEW_RELIC_BROWSER_KEY
}</code></pre>
          </div>

          <!-- .envファイルへの設定 -->
          <h4 class="font-bold text-lg mt-8 text-gray-800">手順3: .envファイルへの設定</h4>
          <p class="text-gray-700">プロジェクトルートに<code class="bg-gray-100 px-2 py-1 rounded">.env</code>ファイルを作成し、取得した値を設定:</p>

          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># .envファイルを作成
cp .env.example .env

# エディタで.envファイルを開き、以下を設定

# APM用（手順1で取得）
NEW_RELIC_API_KEY=your-license-key-here

# RUM用（手順2で取得）
NEXT_PUBLIC_NEW_RELIC_BROWSER_KEY=NRBR-xxxxx
NEXT_PUBLIC_NEW_RELIC_ACCOUNT_ID=9999999
NEXT_PUBLIC_NEW_RELIC_APPLICATION_ID=111111111</code></pre>

          <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500 mt-4">
            <p class="font-semibold text-yellow-800">⚠️ 注意</p>
            <p class="text-gray-700 mt-2">License Keyは秘密情報です。Gitにコミットしないよう注意してください（.gitignoreに.envが登録済み）</p>
          </div>

          <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500 mt-4">
            <p class="font-semibold text-purple-800">💡 RUM設定が必要な理由</p>
            <p class="text-gray-700 mt-2">RUM（Real User Monitoring）を有効にすることで、フロントエンドのページビュー、Ajax、エラー、Core Web Vitalsを計測し、APMと統合したエンドツーエンドの監視が可能になります。</p>
          </div>
        </div>
      </div>

      <!-- 2. Docker Compose起動 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">2. アプリケーションの起動</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">Docker Composeでアプリケーション全体を起動します。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">起動コマンド</h4>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash">docker compose up -d --build</code></pre>

          <div class="bg-blue-50 p-4 rounded-lg mt-4">
            <p class="font-semibold text-blue-800 mb-2">💡 コマンドの説明</p>
            <ul class="list-disc list-inside space-y-1 text-gray-700">
              <li><code class="bg-gray-100 px-2 py-1 rounded">up -d</code>: バックグラウンドでコンテナ起動</li>
              <li><code class="bg-gray-100 px-2 py-1 rounded">--build</code>: イメージを再ビルドしてから起動</li>
            </ul>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">起動確認</h4>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># コンテナの起動状態を確認
docker compose ps</code></pre>
          <p class="mt-2 text-gray-600">全てのコンテナが「Up」状態になっていることを確認してください。</p>
        </div>
      </div>

      <!-- 3. アプリケーションへのアクセス -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">3. デモECサイトへのアクセス</h3>
        <div class="space-y-4 text-gray-700">

          <!-- GitHub Codespacesの場合 -->
          <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500 mb-6">
            <p class="font-semibold text-blue-800 mb-3">GitHub Codespacesの場合</p>
            <p class="text-gray-700 mb-3">VS Codeの下部にある「PORTS」タブからアクセスします。</p>
            <ol class="list-decimal list-inside space-y-2 ml-4 text-gray-700">
              <li>VS Code下部の「PORTS」タブをクリック</li>
              <li>ポート <strong>3000</strong>（フロントエンド）または <strong>8080</strong>（API）の行を確認</li>
              <li>「Forwarded Address」列の地球儀アイコン（🌐）をクリック</li>
              <li>ブラウザの新しいタブでアプリケーションが開きます</li>
            </ol>
          </div>

          <!-- ローカル環境の場合 -->
          <p class="font-semibold text-gray-800">ローカル環境の場合</p>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="bg-green-50 p-6 rounded-lg border-2 border-green-300">
              <h4 class="font-bold text-lg text-green-800 mb-3">フロントエンド</h4>
              <p class="text-gray-700 mb-2">
                <a href="http://localhost:3000" target="_blank" class="text-blue-600 hover:underline font-semibold">
                  http://localhost:3000
                </a>
              </p>
              <p class="text-sm text-gray-600">Next.js製のECサイト画面</p>
            </div>

            <div class="bg-purple-50 p-6 rounded-lg border-2 border-purple-300">
              <h4 class="font-bold text-lg text-purple-800 mb-3">バックエンドAPI</h4>
              <p class="text-gray-700 mb-2">
                <a href="http://localhost:8080/api/docs" target="_blank" class="text-blue-600 hover:underline font-semibold">
                  http://localhost:8080/api/docs
                </a>
              </p>
              <p class="text-sm text-gray-600">Go API + Swagger UI</p>
            </div>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">デモECサイトの操作フロー</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li><strong>TOPページ:</strong> 商品一覧を表示</li>
            <li><strong>商品詳細ページ:</strong> 気になる商品をクリック</li>
            <li><strong>カート追加:</strong> 「カートに追加」ボタンをクリック（数量を選択）</li>
            <li><strong>カートページ:</strong> ヘッダーのカートアイコンから確認</li>
            <li><strong>決済ページ:</strong> 「レジに進む」ボタンをクリック</li>
            <li><strong>注文確定:</strong> 「注文を確定する」ボタンをクリック</li>
          </ol>

          <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500 mt-4">
            <p class="font-semibold text-green-800">✅ 動作確認のポイント</p>
            <p class="text-gray-700 mt-2">複数回操作することで、New Relicに十分なデータが蓄積されます。いろいろな商品を閲覧・カート追加してみましょう！</p>
          </div>
        </div>
      </div>

      <!-- 4. New Relic APM/RUMデータ確認 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">4. New RelicでAPM/RUMデータを確認</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">アプリケーションを操作した後、New Relicでデータを確認します。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">APM（Application Performance Monitoring）の確認</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>
              <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                New Relic
              </a>
              にアクセス
            </li>
            <li>左メニューから「APM & Services」を選択</li>
            <li>「slm-handson-api」（バックエンドアプリケーション）をクリック</li>
            <li>
              <strong>確認ポイント:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li><strong>トランザクション:</strong> APIエンドポイントごとのレスポンスタイム</li>
                <li><strong>エラー:</strong> エラー発生率と詳細</li>
                <li><strong>スループット:</strong> 単位時間あたりのリクエスト数</li>
                <li><strong>データベース:</strong> データベースクエリのパフォーマンス（該当する場合）</li>
              </ul>
            </li>
          </ol>

          <h4 class="font-bold text-lg mt-6 text-gray-800">RUM（Real User Monitoring / Browser）の確認</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>左メニューから「Browser」を選択</li>
            <li>「slm-handson-frontend」（フロントエンドアプリケーション）をクリック</li>
            <li>
              <strong>確認ポイント:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li><strong>Page views:</strong> ページごとのアクセス数とロード時間</li>
                <li><strong>Ajax:</strong> APIリクエストのレスポンスタイムと成功/失敗</li>
                <li><strong>JavaScript errors:</strong> フロントエンドで発生したエラー</li>
                <li><strong>Core Web Vitals:</strong> LCP、FID、CLSなどのUX指標</li>
                <li><strong>Session traces:</strong> ユーザーのページ遷移とアクション履歴</li>
              </ul>
            </li>
          </ol>

          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-6">
            <p class="font-semibold text-blue-800 mb-2">💡 Distributed Tracingで連携確認</p>
            <p class="text-gray-700">「Distributed tracing」メニューから、フロントエンド（Browser）→ バックエンド（API）の完全なリクエストフローを可視化できます。</p>
          </div>

          <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500 mt-4">
            <p class="font-semibold text-yellow-800">⏱️ データ反映までの時間</p>
            <p class="text-gray-700 mt-2">New Relicへのデータ送信には数分かかる場合があります。データが表示されない場合は、少し待ってからリロードしてください。</p>
          </div>
        </div>
      </div>

      <!-- 5. トラブルシューティング -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">5. トラブルシューティング</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">エラーが発生した場合は、以下のコマンドでログを確認してください。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">コンテナログの確認</h4>
          <p class="text-gray-700">各サービスのログを確認することで、エラーの原因を特定できます。</p>

          <!-- APIサーバーのログ確認 -->
          <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-blue-500">
            <p class="font-semibold text-blue-800 mb-2">APIサーバーのログ確認</p>
            <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto mt-2"><code class="language-bash"># APIサーバーのログを表示
docker compose logs api-server

# リアルタイムでログを追跡
docker compose logs -f api-server

# 最新100行のログを表示
docker compose logs --tail 100 api-server</code></pre>
          </div>

          <!-- フロントエンドのログ確認 -->
          <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-green-500 mt-4">
            <p class="font-semibold text-green-800 mb-2">フロントエンドのログ確認</p>
            <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto mt-2"><code class="language-bash"># フロントエンドのログを表示
docker compose logs frontend

# リアルタイムでログを追跡
docker compose logs -f frontend</code></pre>
          </div>

          <!-- 全サービスのログ確認 -->
          <div class="bg-gray-50 p-4 rounded-lg border-l-4 border-purple-500 mt-4">
            <p class="font-semibold text-purple-800 mb-2">全サービスのログ確認</p>
            <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto mt-2"><code class="language-bash"># 全サービスのログを表示
docker compose logs

# リアルタイムで全サービスのログを追跡
docker compose logs -f</code></pre>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">コンテナの再起動</h4>
          <p class="text-gray-700">エラーが解消しない場合は、コンテナを再起動してください。</p>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># 全サービスを再起動
docker compose restart

# 特定のサービスのみ再起動
docker compose restart api-server
docker compose restart frontend</code></pre>

          <h4 class="font-bold text-lg mt-6 text-gray-800">コンテナの完全な再構築</h4>
          <p class="text-gray-700">環境変数の変更が反映されない場合や、イメージに問題がある場合は完全に再構築します。</p>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># 全コンテナを停止して削除
docker compose down

# イメージを再ビルドして起動
docker compose up -d --build</code></pre>

          <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500 mt-4">
            <p class="font-semibold text-yellow-800">⚠️ よくあるエラーと対処法</p>
            <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4 mt-2">
              <li><strong>ポート競合エラー:</strong> すでに3000番や8080番ポートが使用されている場合、他のアプリケーションを停止してください</li>
              <li><strong>New Relicにデータが表示されない:</strong> .envファイルのLicense Keyが正しいか確認してください（数分のタイムラグがある場合もあります）</li>
              <li><strong>コンテナが起動しない:</strong> <code class="bg-gray-100 px-2 py-1 rounded">docker compose ps</code>でステータスを確認し、ログで詳細を確認してください</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- ナビゲーションボタン -->
      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#lecture" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition">
          ← 前へ: 座学
        </a>
        <div class="text-center">
          <p class="text-sm text-gray-600 mb-2 font-medium">休憩時間</p>
          <p class="text-2xl font-bold text-blue-600">10分</p>
        </div>
        <a href="#slo-management" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
          次へ: SLO設定・管理 →
        </a>
      </div>
    </section>

    <!-- SLO設定・管理セクション -->
    <section id="slo-management" class="container mx-auto px-6 py-10 bg-white rounded-lg shadow-md mb-10">
      <h2 class="text-3xl font-bold mb-4 text-gray-800">SLO設定・管理</h2>
      <p class="text-sm text-gray-600 mb-6">推奨時間: 30分</p>

      <div class="text-gray-700 mb-6">
        <p class="text-lg">このセクションでは、実際のアプリケーションでSLOを設計・設定・管理する実技を体験します。</p>
      </div>

      <!-- 1. ユーザージャーニーの特定 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">1. ユーザージャーニーの特定</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">SLO設計の第一歩は、ユーザーにとって最も重要な機能フローを特定することです。</p>

          <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500 mt-4">
            <p class="font-semibold text-blue-800 mb-3">💡 ディスカッション</p>
            <p class="text-gray-700 mb-2"><strong>問:</strong> このECサイトで、最も重要なユーザージャーニーは何でしょうか？</p>
            <p class="text-gray-700 mt-4"><strong>例:</strong> 商品購入フロー（TOPページ → 商品詳細 → カート追加 → カート確認 → 決済完了）</p>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">デモECサイトのユーザージャーニー</h4>

          <!-- ユーザージャーニーフロー図 -->
          <div class="bg-gray-50 p-6 rounded-lg border-2 border-gray-300">
            <!-- 上段: 1〜3 -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 text-center mb-4">
              <div class="bg-blue-100 p-4 rounded-lg border-2 border-blue-400">
                <p class="font-bold text-blue-800">1. TOPページ</p>
                <p class="text-sm text-gray-600 mt-2">商品一覧表示</p>
                <p class="text-xs text-gray-500 mt-1">GET /api/products</p>
              </div>
              <div class="flex items-center justify-center">
                <span class="text-3xl text-gray-400">→</span>
              </div>
              <div class="bg-green-100 p-4 rounded-lg border-2 border-green-400">
                <p class="font-bold text-green-800">2. 商品詳細</p>
                <p class="text-sm text-gray-600 mt-2">商品情報確認</p>
                <p class="text-xs text-gray-500 mt-1">GET /api/products/{"{id}"}</p>
              </div>
              <div class="flex items-center justify-center">
                <span class="text-3xl text-gray-400">→</span>
              </div>
              <div class="bg-purple-100 p-4 rounded-lg border-2 border-purple-400">
                <p class="font-bold text-purple-800">3. カート追加</p>
                <p class="text-sm text-gray-600 mt-2">商品をカートに追加</p>
                <p class="text-xs text-gray-500 mt-1">POST /api/cart/items</p>
              </div>
            </div>
            <!-- 下段: 4〜5 -->
            <div class="grid grid-cols-1 md:grid-cols-5 gap-4 text-center">
              <div class="bg-orange-100 p-4 rounded-lg border-2 border-orange-400">
                <p class="font-bold text-orange-800">4. カート確認</p>
                <p class="text-sm text-gray-600 mt-2">カート内容確認</p>
                <p class="text-xs text-gray-500 mt-1">GET /api/cart</p>
              </div>
              <div class="flex items-center justify-center">
                <span class="text-3xl text-gray-400">→</span>
              </div>
              <div class="bg-yellow-100 p-4 rounded-lg border-2 border-yellow-400">
                <p class="font-bold text-yellow-800">5. 決済完了</p>
                <p class="text-sm text-gray-600 mt-2">注文確定</p>
                <p class="text-xs text-gray-500 mt-1">POST /api/orders</p>
              </div>
            </div>
          </div>

          <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500 mt-4">
            <p class="font-semibold text-green-800">✅ 重要なポイント</p>
            <p class="text-gray-700 mt-2">このユーザージャーニーは、ECサイトにおける最も重要なコンバージョン経路です。この経路の可用性とパフォーマンスがビジネスに直結します。</p>
          </div>
        </div>
      </div>

      <!-- 2. SLI設計ワークフロー -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">2. SLI設計ワークフロー</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">ユーザージャーニーを特定したら、各ステップのSLIを設計します。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">SLI設計の3つのアプローチ</h4>

          <!-- 成功率ベースのSLI -->
          <div class="bg-blue-50 p-6 rounded-lg border-l-4 border-blue-500">
            <p class="font-semibold text-xl mb-3 text-blue-800">📊 成功率ベースのSLI（APM）</p>
            <div class="space-y-3">
              <p><strong>計算式:</strong> 成功したリクエスト数 / 全リクエスト数</p>
              <p><strong>対象:</strong> APIエンドポイント（バックエンド）</p>
              <div class="bg-white p-4 rounded-lg mt-3">
                <p class="font-bold text-gray-800 mb-2">例: 商品詳細APIの成功率</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>SLI: HTTPステータス200のリクエスト数 / 全リクエスト数</li>
                  <li>SLO目標: 成功率 >= 99.9%</li>
                  <li>意味: 1000回のアクセスのうち、999回は成功する必要がある</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- レスポンスタイムベースのSLI -->
          <div class="bg-green-50 p-6 rounded-lg border-l-4 border-green-500 mt-6">
            <p class="font-semibold text-xl mb-3 text-green-800">⏱️ レスポンスタイムベースのSLI（APM）</p>
            <div class="space-y-3">
              <p><strong>計算式:</strong> 指定時間内に完了したリクエスト数 / 全リクエスト数</p>
              <p><strong>対象:</strong> APIエンドポイント（バックエンド）</p>
              <div class="bg-white p-4 rounded-lg mt-3">
                <p class="font-bold text-gray-800 mb-2">例: カート追加APIのレスポンスタイム</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>SLI: 300ms以内に完了したリクエスト数 / 全リクエスト数</li>
                  <li>SLO目標: 95パーセンタイル &lt; 300ms</li>
                  <li>意味: 100回のリクエストのうち、95回は300ms以内に完了する必要がある</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- Core Web VitalsベースのSLI -->
          <div class="bg-pink-50 p-6 rounded-lg border-l-4 border-pink-500 mt-6">
            <p class="font-semibold text-xl mb-3 text-pink-800">🖼️ Core Web VitalsベースのSLI（RUM / Browser）</p>
            <div class="space-y-3">
              <p><strong>計算式:</strong> 基準値内のページビュー数 / 全ページビュー数</p>
              <p><strong>対象:</strong> フロントエンドのユーザー体験（ブラウザ側）</p>
              <div class="bg-white p-4 rounded-lg mt-3">
                <p class="font-bold text-gray-800 mb-2">例: 商品一覧ページのLCP（Largest Contentful Paint）</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>SLI: LCP 2.5秒以内のページビュー数 / 全ページビュー数</li>
                  <li>SLO目標: 90%のページビューがLCP 2.5秒以内</li>
                  <li>意味: 商品画像が2.5秒以内に表示され、ユーザーがストレスなく閲覧できる</li>
                </ul>
              </div>
              <div class="bg-pink-100 p-3 rounded-lg mt-3">
                <p class="text-sm text-gray-700"><strong>💡 APMとの違い:</strong> APMはサーバー側の処理時間を計測しますが、RUMはブラウザ側の実際のユーザー体験（ネットワーク遅延、レンダリング時間含む）を計測します。</p>
              </div>
            </div>
          </div>

          <!-- SLI設計のステップ -->
          <div class="bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500 mt-6">
            <p class="font-semibold text-xl mb-3 text-yellow-800">🎯 SLI設計の3ステップ</p>
            <ol class="list-decimal list-inside space-y-2 text-gray-700 ml-4">
              <li><strong>ユーザー視点で重要な指標を選択:</strong> エラー率？レスポンスタイム？表示速度？</li>
              <li><strong>測定可能な指標に変換:</strong> 成功率？95パーセンタイル？LCP？</li>
              <li><strong>現実的な目標値を設定:</strong> 過去のデータと組織の能力を考慮</li>
            </ol>
          </div>
        </div>
      </div>

      <!-- 3. New Relic Service Level ManagementでSLOを作成 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">3. New Relic Service Level ManagementでSLOを作成</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">設計したSLIをNew Relic UIで実装しましょう。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">手順: SLOの作成</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>
              <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                New Relic
              </a>
              にアクセス
            </li>
            <li>左メニューから「Service levels」を選択</li>
            <li>右上の「+ Add a service level」ボタンをクリック</li>
            <li>
              <strong>エンティティを選択:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li>APMの場合: 「slm-handson-api」を選択</li>
                <li>Browserの場合: 「slm-handson-frontend」を選択</li>
              </ul>
            </li>
            <li>
              <strong>SLIを設定:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li>「Success」タイプ: 成功率ベースのSLI</li>
                <li>「Latency」タイプ: レスポンスタイムベースのSLI</li>
              </ul>
            </li>
            <li>
              <strong>SLO目標値を設定:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li>Target: 99.9%（推奨）</li>
                <li>Time window: 7 days または 28 days</li>
              </ul>
            </li>
            <li>「Create」ボタンをクリックして保存</li>
          </ol>

          <h4 class="font-bold text-lg mt-6 text-gray-800">実践例: CUJ（購入フロー全体）の可用性SLO</h4>

          <div class="bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500 mb-6">
            <p class="font-semibold text-xl mb-3 text-purple-800">🎯 推奨アプローチ: ユーザージャーニー全体を1つのSLOで管理</p>
            <p class="text-gray-700 mb-3">
              個別のエンドポイントごとではなく、<strong>購入フロー全体</strong>を1つのSLOとして設定することで、
              ビジネス価値と直結した可用性を測定できます。
            </p>
            <p class="text-gray-700 text-sm">
              <strong>対象エンドポイント:</strong>
              商品一覧 → 商品詳細 → カート追加 → カート確認 → 注文確定
            </p>
          </div>

          <!-- 推奨SLO: 購入フロー全体の可用性 -->
          <div class="bg-blue-50 p-6 rounded-lg border-2 border-blue-400">
            <p class="font-bold text-xl text-blue-800 mb-4">📊 購入フロー可用性SLO（推奨）</p>
            <div class="space-y-3 text-gray-700">
              <p><strong>エンティティ:</strong> slm-handson-api (APM)</p>
              <p><strong>SLIタイプ:</strong> Success（成功率ベース）</p>
              <p><strong>SLO目標:</strong> 99.9%</p>
              <p><strong>Time window:</strong> 28 days（推奨）</p>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Valid events（全リクエスト）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM Transaction
SELECT count(*) as 'Valid'
WHERE
  request.uri = '/api/products'
  OR request.uri LIKE '/api/products/%'
  OR request.uri = '/api/cart/items'
  OR request.uri = '/api/cart'
  OR request.uri = '/api/orders'</code></pre>
              </div>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Good events（成功リクエスト）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM Transaction
SELECT count(*) as 'Good'
WHERE
  (request.uri = '/api/products'
   OR request.uri LIKE '/api/products/%'
   OR request.uri = '/api/cart/items'
   OR request.uri = '/api/cart'
   OR request.uri = '/api/orders')
AND httpResponseCode &lt; 500
AND error IS NOT true</code></pre>
              </div>

              <div class="mt-4 bg-white p-4 rounded-lg">
                <p class="font-bold text-gray-800 mb-2">💡 このSLOの意味</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 text-sm ml-4">
                  <li><strong>99.9%の可用性目標:</strong> 1000回のリクエストのうち999回は成功する</li>
                  <li><strong>成功の定義:</strong> 5xxエラーでない、かつAPMエラーでない</li>
                  <li><strong>4xxエラーは成功扱い:</strong> クライアント側の問題はサーバー可用性に含めない</li>
                  <li><strong>ビジネス価値:</strong> 購入フロー全体の信頼性をダイレクトに測定</li>
                </ul>
              </div>
            </div>
          </div>

          <h4 class="font-bold text-lg mt-8 text-gray-800">実践例: 購入フローレイテンシSLO</h4>

          <div class="bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500 mb-6">
            <p class="font-semibold text-xl mb-3 text-purple-800">⏱️ エンドポイント特性に応じた条件付き閾値</p>
            <p class="text-gray-700 mb-3">
              APIの特性によって許容できるレスポンスタイムは異なります。<strong>参照系（GET）</strong>は高速であるべきですが、
              <strong>更新系（POST）</strong>は処理が重いため、より長い時間を許容します。
              これらを<strong>1つのSLO</strong>で統合的に管理します。
            </p>
            <div class="bg-white p-4 rounded-lg mt-3">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-gray-300">
                    <th class="text-left py-2">分類</th>
                    <th class="text-left py-2">対象API</th>
                    <th class="text-left py-2">閾値</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-b border-gray-200">
                    <td class="py-2 text-green-700 font-semibold">参照系</td>
                    <td class="py-2">GET /api/products, GET /api/products/{id}, GET /api/cart</td>
                    <td class="py-2">300ms</td>
                  </tr>
                  <tr>
                    <td class="py-2 text-orange-700 font-semibold">更新系</td>
                    <td class="py-2">POST /api/cart/items, POST /api/orders</td>
                    <td class="py-2">1000ms</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- SLO②: 購入フローレイテンシSLO -->
          <div class="bg-green-50 p-6 rounded-lg border-2 border-green-400">
            <p class="font-bold text-xl text-green-800 mb-4">⏱️ 購入フローレイテンシSLO</p>
            <div class="space-y-3 text-gray-700">
              <p><strong>エンティティ:</strong> slm-handson-api (APM)</p>
              <p><strong>SLIタイプ:</strong> Latency（レスポンスタイムベース）</p>
              <p><strong>SLO目標:</strong> 95%</p>
              <p><strong>Time window:</strong> 28 days（推奨）</p>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Valid events（購入フロー全リクエスト）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM Transaction
SELECT count(*) as 'Valid'
WHERE
  request.uri = '/api/products'
  OR request.uri LIKE '/api/products/%'
  OR request.uri = '/api/cart'
  OR request.uri = '/api/cart/items'
  OR request.uri = '/api/orders'</code></pre>
              </div>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Good events（閾値内に完了 - 条件付き）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM Transaction
SELECT count(*) as 'Good'
WHERE
  -- 参照系: 300ms以内
  ((request.uri = '/api/products'
    OR request.uri LIKE '/api/products/%'
    OR request.uri = '/api/cart')
   AND duration &lt; 0.3)
  OR
  -- 更新系: 1000ms以内
  ((request.uri = '/api/cart/items'
    OR request.uri = '/api/orders')
   AND duration &lt; 1.0)</code></pre>
              </div>

              <div class="mt-4 bg-white p-4 rounded-lg">
                <p class="font-bold text-gray-800 mb-2">💡 このSLOの意味</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 text-sm ml-4">
                  <li><strong>統合的なレイテンシ管理:</strong> 購入フロー全体を1つのSLOで可視化</li>
                  <li><strong>参照系は300ms以内:</strong> 商品一覧・詳細・カート確認など（サクサク感）</li>
                  <li><strong>更新系は1秒以内:</strong> カート追加・決済など（処理時間を許容）</li>
                  <li><strong>ユーザー体験:</strong> 各APIの特性に応じた適切な閾値でUXを保証</li>
                </ul>
              </div>
            </div>
          </div>

          <h4 class="font-bold text-lg mt-8 text-gray-800">実践例: フロントエンド表示速度SLO（LCP）</h4>

          <div class="bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500 mb-6">
            <p class="font-semibold text-xl mb-3 text-purple-800">🖼️ LCP (Largest Contentful Paint) とは</p>
            <p class="text-gray-700 mb-3">
              ページ内で最も大きなコンテンツ（商品画像など）が表示されるまでの時間です。
              ECサイトでは<strong>商品画像の表示速度</strong>が第一印象を決め、離脱率に直結します。
            </p>
            <div class="bg-white p-4 rounded-lg mt-3">
              <p class="font-bold text-gray-800 mb-2">Googleの推奨基準</p>
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-gray-300">
                    <th class="text-left py-2">評価</th>
                    <th class="text-left py-2">LCP時間</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="border-b border-gray-200">
                    <td class="py-2 text-green-700 font-semibold">Good</td>
                    <td class="py-2">2.5秒以内</td>
                  </tr>
                  <tr class="border-b border-gray-200">
                    <td class="py-2 text-yellow-700 font-semibold">Needs Improvement</td>
                    <td class="py-2">2.5〜4秒</td>
                  </tr>
                  <tr>
                    <td class="py-2 text-red-700 font-semibold">Poor</td>
                    <td class="py-2">4秒超</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <!-- SLO③: フロントエンドLCP -->
          <div class="bg-pink-50 p-6 rounded-lg border-2 border-pink-400">
            <p class="font-bold text-xl text-pink-800 mb-4">🖼️ フロントエンド表示速度SLO（LCP）</p>
            <div class="space-y-3 text-gray-700">
              <p><strong>エンティティ:</strong> slm-handson-frontend (Browser)</p>
              <p><strong>SLIタイプ:</strong> Latency（Core Web Vitals - LCP）</p>
              <p><strong>SLO目標:</strong> 90%</p>
              <p><strong>Time window:</strong> 28 days（推奨）</p>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Valid events（購入フローのページビュー）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM PageViewTiming
SELECT count(*) as 'Valid'
WHERE
  pageUrl LIKE '%/products%'
  OR pageUrl LIKE '%/cart%'
  OR pageUrl LIKE '%/checkout%'
  OR pageUrl RLIKE '^https?://[^/]+/?$'</code></pre>
                <p class="text-xs text-gray-500 mt-2">※ 最後の行はTOPページ（ドメイン直下）にマッチ。localhost でも Codespaces でも動作します。</p>
              </div>

              <div class="mt-4">
                <p class="font-bold text-gray-800 mb-2">Good events（LCP 2.5秒以内）:</p>
                <pre class="bg-gray-900 text-gray-100 p-3 rounded text-sm overflow-x-auto"><code class="language-sql">FROM PageViewTiming
SELECT count(*) as 'Good'
WHERE
  (pageUrl LIKE '%/products%'
   OR pageUrl LIKE '%/cart%'
   OR pageUrl LIKE '%/checkout%'
   OR pageUrl RLIKE '^https?://[^/]+/?$')
AND largestContentfulPaint &lt; 2500</code></pre>
              </div>

              <div class="mt-4 bg-white p-4 rounded-lg">
                <p class="font-bold text-gray-800 mb-2">💡 このSLOの意味</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 text-sm ml-4">
                  <li><strong>90%のページビューがLCP 2.5秒以内:</strong> Googleの「Good」基準を満たす</li>
                  <li><strong>フロントエンド視点:</strong> APMでは見えないブラウザ側のUXを測定</li>
                  <li><strong>商品画像の表示速度:</strong> ECサイトの第一印象に直結</li>
                  <li><strong>離脱率への影響:</strong> LCP改善は離脱率低下に最も効果的</li>
                </ul>
              </div>
            </div>
          </div>

          <!-- SLOまとめ -->
          <div class="bg-gray-50 p-6 rounded-lg border-2 border-gray-300 mt-6">
            <p class="font-bold text-xl text-gray-800 mb-4">📋 ハンズオンで作成するSLOまとめ</p>
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b-2 border-gray-400">
                  <th class="text-left py-2">SLO名</th>
                  <th class="text-left py-2">タイプ</th>
                  <th class="text-left py-2">目標</th>
                  <th class="text-left py-2">対象</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b border-gray-200">
                  <td class="py-2 font-semibold text-blue-700">購入フロー可用性</td>
                  <td class="py-2">Success</td>
                  <td class="py-2">99.9%</td>
                  <td class="py-2">APM: 全購入フローAPI</td>
                </tr>
                <tr class="border-b border-gray-200">
                  <td class="py-2 font-semibold text-green-700">購入フローレイテンシ</td>
                  <td class="py-2">Latency</td>
                  <td class="py-2">95%</td>
                  <td class="py-2">APM: 参照系 &lt; 300ms / 更新系 &lt; 1000ms</td>
                </tr>
                <tr>
                  <td class="py-2 font-semibold text-pink-700">フロントエンド表示速度</td>
                  <td class="py-2">Latency (LCP)</td>
                  <td class="py-2">90%</td>
                  <td class="py-2">Browser: LCP &lt; 2.5秒</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500 mt-4">
            <p class="font-semibold text-yellow-800">📝 ワークショップTips</p>
            <p class="text-gray-700 mt-2">今回は3つのSLOを作成します（APM 2つ + Browser 1つ）。実運用でも1〜3つのSLOから始めることをお勧めします。多すぎるSLOは管理が困難になり、本質的な改善活動から遠ざかる原因になります。</p>
          </div>
        </div>
      </div>

      <!-- 4. パフォーマンス劣化シミュレーションとSLO違反体験 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">4. パフォーマンス劣化シミュレーションとSLO違反体験</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">環境変数を変更して、意図的にパフォーマンスを劣化させ、SLO違反を体験しましょう。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">手順: パフォーマンス劣化のシミュレーション</h4>

          <div class="bg-red-50 p-6 rounded-lg border-l-4 border-red-500">
            <p class="font-semibold text-red-800 mb-3">⚠️ 環境変数の変更</p>
            <p class="text-gray-700 mb-4">プロジェクトルートの<code class="bg-gray-100 px-2 py-1 rounded">.env</code>ファイルを編集します。</p>

            <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># エラー率を30%に上昇（デフォルト: 10%）
ERROR_RATE=0.3

# 最大レスポンスタイムを2000msに増加（デフォルト: 500ms）
RESPONSE_TIME_MAX=2000

# 最小レスポンスタイムを500msに増加（デフォルト: 50ms）
RESPONSE_TIME_MIN=500</code></pre>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">APIサーバーの再起動</h4>
          <p class="text-gray-700">環境変数を変更したら、APIサーバーを再起動して反映させます。</p>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># APIサーバーのみ再起動
docker compose up -d api-server

# 起動確認
docker compose ps api-server</code></pre>

          <h4 class="font-bold text-lg mt-6 text-gray-800">自動ユーザージャーニー負荷生成の開始</h4>
          <p class="text-gray-700">Playwrightベースの自動ユーザージャーニー負荷生成を開始し、継続的なアクセスを生成します。</p>
          <pre class="rounded-lg bg-gray-900 text-gray-100 p-4 overflow-x-auto"><code class="language-bash"># 2段階起動でネットワークエラー回避
docker compose up -d
docker compose --profile playwright up playwright-generator

# カスタム設定での実行（短時間テスト: 5分間、10秒間隔）
DURATION=300 ACCESS_INTERVAL=10 docker compose --profile playwright up playwright-generator</code></pre>

          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-4">
            <p class="font-semibold text-blue-800 mb-2">💡 負荷生成スクリプトの動作</p>
            <p class="text-gray-700">Playwrightスクリプトは、リアルなブラウザ操作を自動実行します：</p>
            <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4 mt-2">
              <li>TOPページ訪問 → 商品詳細表示 → カート追加 → カート確認 → 決済完了</li>
              <li>各ステップ間で1-5秒のランダム思考時間</li>
              <li>完全なRUM/APMデータ生成（Page views, Ajax, エラー、トレース）</li>
            </ul>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">New RelicダッシュボードでSLO違反を確認</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>
              <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                New Relic
              </a>
              にアクセス
            </li>
            <li>左メニューから「Service levels」を選択</li>
            <li>作成したSLOをクリック</li>
            <li>
              <strong>確認ポイント:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li><strong>SLO達成率:</strong> 目標値（99.9%）を下回っているか確認</li>
                <li><strong>エラーバジェット残量:</strong> 消費状況を確認</li>
                <li><strong>グラフ:</strong> 成功率やレスポンスタイムの推移を確認</li>
                <li><strong>違反期間:</strong> いつからSLOを下回り始めたか確認</li>
              </ul>
            </li>
          </ol>

          <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500 mt-4">
            <p class="font-semibold text-green-800">✅ 体験のポイント</p>
            <p class="text-gray-700 mt-2">パフォーマンス劣化により、実際にSLOが違反される様子を観察できます。これにより、SLO管理の重要性と、リアルタイム監視の価値を体感できます。</p>
          </div>
        </div>
      </div>

      <!-- 5. エラーバジェット運用とアラート設定 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">5. エラーバジェット運用とアラート設定</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">エラーバジェットを理解し、SLO違反時のアラート設定と意思決定プロセスを学びましょう。</p>

          <h4 class="font-bold text-lg mt-6 text-gray-800">エラーバジェットとは</h4>
          <div class="bg-purple-50 p-6 rounded-lg border-l-4 border-purple-500">
            <p class="font-semibold text-xl mb-3 text-purple-800">📊 エラーバジェットの定義</p>
            <p class="text-gray-700 mb-4">エラーバジェットとは、SLO目標値を達成するために許容される「失敗の余地」です。</p>

            <div class="bg-white p-4 rounded-lg mt-3">
              <p class="font-bold text-gray-800 mb-2">計算例: SLO 99.9%の場合</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 ml-4">
                <li><strong>目標:</strong> 1000回のリクエストのうち、999回は成功する</li>
                <li><strong>エラーバジェット:</strong> 1000回のリクエストのうち、1回は失敗しても良い（0.1%）</li>
                <li><strong>月間エラーバジェット:</strong> 約43分のダウンタイム許容</li>
              </ul>
            </div>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">New Relicでのエラーバジェット確認</h4>
          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>
              <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                New Relic
              </a>
              → 「Service levels」
            </li>
            <li>作成したSLOをクリック</li>
            <li>
              <strong>エラーバジェット表示:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li><strong>Remaining error budget:</strong> 残りのエラーバジェット（%表示）</li>
                <li><strong>Error budget consumed:</strong> 消費したエラーバジェット</li>
                <li><strong>Time window:</strong> 計測期間（7日間 or 28日間）</li>
              </ul>
            </li>
          </ol>

          <h4 class="font-bold text-lg mt-6 text-gray-800">SLO違反時のアラート設定</h4>
          <p class="text-gray-700">エラーバジェットが枯渇する前にアラートを設定し、事前に対応できるようにします。</p>

          <ol class="list-decimal list-inside space-y-3 ml-4">
            <li>Service Levelページで「Alert conditions」タブを選択</li>
            <li>「+ Add alert condition」をクリック</li>
            <li>
              <strong>アラート条件の設定:</strong>
              <ul class="list-disc list-inside space-y-1 ml-6 mt-2">
                <li><strong>Condition type:</strong> Error budget consumption</li>
                <li><strong>Threshold:</strong> 80%（エラーバジェットの80%を消費したら警告）</li>
                <li><strong>Time window:</strong> 1 hour（1時間以内に80%消費）</li>
              </ul>
            </li>
            <li>通知先（Slack、Email等）を設定</li>
            <li>「Create」ボタンをクリックして保存</li>
          </ol>

          <h4 class="font-bold text-lg mt-6 text-gray-800">エラーバジェット枯渇時の意思決定シナリオ</h4>
          <div class="bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500">
            <p class="font-semibold text-xl mb-3 text-yellow-800">🤔 ディスカッション: エラーバジェットが枯渇したら？</p>

            <div class="space-y-4 mt-4">
              <div class="bg-white p-4 rounded-lg">
                <p class="font-bold text-red-600 mb-2">シナリオA: 機能凍結（Feature Freeze）</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>新機能のリリースを一時停止</li>
                  <li>全リソースを信頼性向上に集中</li>
                  <li>エラーバジェットが回復するまで待機</li>
                </ul>
              </div>

              <div class="bg-white p-4 rounded-lg">
                <p class="font-bold text-blue-600 mb-2">シナリオB: リスクを取る</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>ビジネス上の緊急性が高い場合、リスクを承知で新機能をリリース</li>
                  <li>リスクと利益のトレードオフを経営層と共有</li>
                  <li>追加の監視とロールバック準備を強化</li>
                </ul>
              </div>

              <div class="bg-white p-4 rounded-lg">
                <p class="font-bold text-green-600 mb-2">シナリオC: SLO目標の再評価</p>
                <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
                  <li>SLO目標が厳しすぎる場合、現実的な値に調整</li>
                  <li>ユーザー影響とビジネス影響を再分析</li>
                  <li>組織の成熟度に応じた目標設定</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-4">
            <p class="font-semibold text-blue-800 mb-2">💡 SLM運用のベストプラクティス</p>
            <ul class="list-disc list-inside space-y-1 text-gray-700 ml-4">
              <li>エラーバジェットは「リスクを取るための資本」として活用する</li>
              <li>ゼロエラーを目指すのではなく、ユーザーにとって適切な信頼性を目指す</li>
              <li>エラーバジェットの消費状況をチーム全体で共有する</li>
              <li>定期的にSLOを見直し、ビジネスとユーザーニーズに合わせて調整する</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- 6. Next Steps: SLOは設定してからが本番 -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">6. Next Steps: SLOは設定してからが本番</h3>
        <div class="space-y-4 text-gray-700">

          <div class="bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg border-2 border-purple-300">
            <div class="flex items-center space-x-4 mb-4">
              <img src="/images/nrug-sre.png" alt="NRUG-SRE マスコットキャラクター" class="h-16 w-auto"/>
              <div>
                <p class="text-2xl font-bold text-purple-800">おめでとうございます！🎉</p>
                <p class="text-gray-700 mt-1">SLOの設定が完了しました。でも、ここからが本当のスタートです。</p>
              </div>
            </div>
            <p class="text-lg text-gray-700">
              SLOは<strong class="text-purple-700">「設定して終わり」ではなく「設定してからが本番」</strong>です。
              継続的な改善と運用の中で、SLOの真価が発揮されます。
            </p>
          </div>

          <h4 class="font-bold text-lg mt-6 text-gray-800">ワークショップ後に取り組むべきこと</h4>

          <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
            <!-- SLOの継続的改善 -->
            <div class="bg-blue-50 p-5 rounded-lg border-l-4 border-blue-500">
              <p class="font-bold text-lg text-blue-800 mb-3">📈 SLOの継続的改善</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                <li>実データに基づくSLO目標値の調整</li>
                <li>新機能追加時のSLI/SLO見直し</li>
                <li>ユーザーフィードバックを反映した指標の追加</li>
                <li>定期的なSLOレビュー会議の実施</li>
              </ul>
            </div>

            <!-- エラーバジェット活用の最適化 -->
            <div class="bg-green-50 p-5 rounded-lg border-l-4 border-green-500">
              <p class="font-bold text-lg text-green-800 mb-3">💰 エラーバジェット活用の最適化</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                <li>エラーバジェットポリシーの策定</li>
                <li>バジェット消費時の意思決定フロー確立</li>
                <li>チーム間でのエラーバジェット共有</li>
                <li>バジェットを活用した「攻めの開発」</li>
              </ul>
            </div>

            <!-- バーンレートアラート -->
            <div class="bg-orange-50 p-5 rounded-lg border-l-4 border-orange-500">
              <p class="font-bold text-lg text-orange-800 mb-3">🔥 バーンレートアラートの設定</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                <li>Fast burn / Slow burn アラートの設定</li>
                <li>エラーバジェット消費速度の監視</li>
                <li>予測に基づく早期警告システム</li>
                <li>オンコール体制との連携</li>
              </ul>
            </div>

            <!-- 組織への展開 -->
            <div class="bg-purple-50 p-5 rounded-lg border-l-4 border-purple-500">
              <p class="font-bold text-lg text-purple-800 mb-3">🏢 組織への展開</p>
              <ul class="list-disc list-inside space-y-2 text-gray-700 text-sm">
                <li>他サービスへのSLO導入</li>
                <li>ステークホルダーへのダッシュボード共有</li>
                <li>SLOを活用した振り返り文化の醸成</li>
                <li>SREプラクティスの段階的導入</li>
              </ul>
            </div>
          </div>

          <div class="bg-yellow-50 p-6 rounded-lg border-l-4 border-yellow-500 mt-6">
            <p class="font-semibold text-xl mb-3 text-yellow-800">🎯 覚えておいてほしいこと</p>
            <ul class="list-disc list-inside space-y-2 text-gray-700">
              <li><strong>完璧を目指さない:</strong> 最初のSLOは仮説。運用しながら改善していく</li>
              <li><strong>少ないSLOから始める:</strong> 3つ以下のSLOでスタートし、必要に応じて追加</li>
              <li><strong>チーム全員で所有する:</strong> SLOはSREだけのものではなく、プロダクトチーム全体の指標</li>
              <li><strong>定期的に振り返る:</strong> 月次/四半期でSLOの妥当性を評価し、調整する</li>
            </ul>
          </div>

          <div class="bg-gray-800 text-white p-6 rounded-lg mt-6">
            <p class="text-xl font-bold text-center mb-4">🚀 SLOの旅は始まったばかり</p>
            <p class="text-center text-gray-300">
              今日学んだことを活かして、ユーザーに価値を届け続けるサービスを目指しましょう。<br/>
              SLOは、そのための強力な羅針盤になります。
            </p>
          </div>

        </div>
      </div>

      <!-- 7. 後片付け -->
      <div class="mb-10">
        <h3 class="text-2xl font-bold mb-4 text-blue-700">7. 後片付け</h3>
        <div class="space-y-4 text-gray-700">
          <p class="text-lg">ハンズオン終了後は、以下の手順でリソースを削除してください。</p>

          <!-- Codespacesの削除 -->
          <div class="bg-red-50 p-6 rounded-lg border-l-4 border-red-500">
            <p class="font-bold text-lg text-red-800 mb-3">🗑️ GitHub Codespacesの削除</p>
            <p class="text-gray-700 mb-3">Codespacesは停止していてもストレージの無料枠を消費します。不要になったら削除しましょう。</p>
            <ol class="list-decimal list-inside space-y-2 text-gray-700 ml-4">
              <li>
                <a href="https://github.com/codespaces" target="_blank" class="text-blue-600 hover:underline font-semibold">
                  GitHub Codespaces管理ページ
                </a>
                にアクセス
              </li>
              <li>削除したいCodespaceの右側にある「...」メニューをクリック</li>
              <li>「Delete」を選択</li>
              <li>確認ダイアログで「Delete」をクリック</li>
            </ol>
            <div class="bg-white p-3 rounded-lg mt-4">
              <p class="text-sm text-gray-600">💡 <strong>Tip:</strong> 無料枠（月間15GBストレージ・120コア時間）を節約するため、使わないCodespacesは早めに削除することをお勧めします。</p>
            </div>
          </div>

          <!-- API Keyの削除 -->
          <div class="bg-orange-50 p-6 rounded-lg border-l-4 border-orange-500 mt-6">
            <p class="font-bold text-lg text-orange-800 mb-3">🔑 New Relic API Keyの削除</p>
            <p class="text-gray-700 mb-3">ハンズオン用に作成したAPI Keyは、不要になったら削除してセキュリティリスクを軽減しましょう。</p>
            <ol class="list-decimal list-inside space-y-2 text-gray-700 ml-4">
              <li>
                <a href="https://one.newrelic.com" target="_blank" class="text-blue-600 hover:underline font-semibold">
                  New Relic
                </a>
                にログイン
              </li>
              <li>左下のユーザーアイコン → 「API Keys」をクリック</li>
              <li>削除したいキーの右側にある「...」メニューをクリック</li>
              <li>「Delete」を選択</li>
              <li>確認ダイアログで削除を確定</li>
            </ol>
            <div class="bg-white p-3 rounded-lg mt-4">
              <p class="text-sm text-gray-600">⚠️ <strong>注意:</strong> 本番環境で使用しているキーは削除しないでください。ハンズオン用に作成したキーのみを削除します。</p>
            </div>
          </div>

          <!-- SLOの保持について -->
          <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mt-6">
            <p class="font-semibold text-blue-800 mb-2">💡 作成したSLOについて</p>
            <p class="text-gray-700">New Relicで作成したSLOは、そのまま残しておいても課金に影響はありません。学習のために残しておくか、不要であれば「Service levels」から削除できます。</p>
          </div>

        </div>
      </div>

      <!-- ナビゲーションボタン -->
      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <a href="#setup" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition">
          ← 前へ: 環境セットアップ
        </a>
        <a href="#toc" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition">
          目次へ戻る
        </a>
      </div>
    </section>

    <!-- フッター -->
    <footer id="footer" class="bg-gray-800 text-white py-6 mt-12">
      <div class="container mx-auto px-6 flex items-center justify-center space-x-4">
        <img src="/images/nrug-sre.png" alt="NRUG-SRE マスコットキャラクター" class="h-12 w-auto"/>
        <p>&copy; 2025 New Relic SLM ハンズオン | NRUG-SRE</p>
      </div>
    </footer>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
